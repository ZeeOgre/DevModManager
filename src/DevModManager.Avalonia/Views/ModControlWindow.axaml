<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:vm="clr-namespace:DevModManager.Core.ViewModels;assembly=DevModManager.Core"
        mc:Ignorable="d"
        x:Class="DevModManager.Avalonia.Views.ModControlWindow"
        x:DataType="vm:ModControlViewModel"
        Width="420"
        Height="480"
        CanResize="True"
        Title="Mod Control">
  <Border Padding="8">
    <StackPanel Spacing="12">
      <!-- Mod name as a clickable element (handled in code-behind to choose the right command) -->
      <Button Name="ModNameButton"
              Content="{Binding Name}"
              Background="Transparent"
              BorderBrush="Transparent"
              Foreground="#4FA3FF"
              FontWeight="Bold"
              HorizontalAlignment="Left"/>

      <!-- Stage display -->
      <StackPanel Orientation="Horizontal" Spacing="8" VerticalAlignment="Center">
        <TextBlock Text="Stage:" VerticalAlignment="Center"/>
        <TextBlock Text="{Binding Stage}" FontWeight="SemiBold" VerticalAlignment="Center"/>
      </StackPanel>

      <Separator/>

      <!-- Action grid: two columns (expand to three by adding ColumnDefinitions/Buttons) -->
      <Grid ColumnDefinitions="*,*" RowDefinitions="Auto,Auto,Auto,Auto">
        <!-- Row 0 -->
        <Button Grid.Row="0" Grid.Column="0" Content="Backup" Command="{Binding OpenBackupCommand}" Margin="4"/>
        <Button Grid.Row="0" Grid.Column="1" Content="Rebuild Archives" Command="{Binding PackageCommand}" Margin="4"/>

        <!-- Row 1 -->
        <Button Grid.Row="1" Grid.Column="0" Content="Fix Audio Paths" Command="{Binding FixAudioPathsCommand}" Margin="4"/>
        <Button Grid.Row="1" Grid.Column="1" Content="Promote" Command="{Binding PromoteCommand}" Margin="4"/>

        <!-- Row 2 -->
        <Button Grid.Row="2" Grid.Column="0" Content="Make Linked AF" Command="{Binding MakeLinkedAfCommand}" Margin="4"/>
        <StackPanel Grid.Row="2" Grid.Column="1" Orientation="Horizontal" Spacing="6" Margin="4">
          <Button Content="Git: Status" Command="{Binding GitStatusCommand}" />
          <Button Content="Git: Commit" Command="{Binding GitCommitCommand}" />
          <Button Content="Git: Push" Command="{Binding GitPushCommand}" />
        </StackPanel>

        <!-- Row 3 -->
        <Button Grid.Row="3" Grid.Column="0" Content="Infer AchList" Command="{Binding InferAchListCommand}" Margin="4"/>
        <Button Grid.Row="3" Grid.Column="1" Content="Convert TES" Command="{Binding ConvertTesCommand}" Margin="4"/>
      </Grid>

      <Separator/>

      <!-- Import from Prod -->
      <Button Content="Import from Prod" Command="{Binding ImportFromProdCommand}" HorizontalAlignment="Stretch"/>
    </StackPanel>
  </Border>
</Window>